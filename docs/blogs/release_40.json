{
  "Title": "Creating Custom Hooks in ReactJS",
  "Slug": "creating-custom-hooks-reactjs",
  "Collection ID": "642da2c43fe34c364a69857f",
  "Item ID": "642da2c43fe34ce659698a4d",
  "Created On": "Fri Aug 05 2022 16:29:25 GMT+0000 (Coordinated Universal Time)",
  "Updated On": "Thu Mar 02 2023 20:57:13 GMT+0000 (Coordinated Universal Time)",
  "PublishedOn": "Wed Apr 05 2023 16:53:15 GMT+0000 (Coordinated Universal Time)",
  "MainImage": "https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62ed62f14a15f471779b2031_react_hooks.png",
  "Post summary": "Let's unravel all of the mysteries of custom hooks! We'll also take a look at a good number of examples of creating our own React custom hooks.",
  "FullPost": "<p id=\"\">Do these scenarios sound familiar to you? You need a loading state, a success and error state from the fetch API, a mechanism to cache data, to check the current mouse pointer, and on and on, all in different components. We repeat this logic multiple times across multiple components. If you take a closer look, you'll find that each scenario requires you to have its own state, which depends on a life cycle method like useEffect. You can go ahead and write the logic for this in each of your components, or you can create a common wrapper that has its own state variables and useEffect that helps to maintain its own isolated state. In other words, you can write custom hooks.</p><p id=\"\">In this article, we are going to unravel all of the mysteries related to custom hooks and take a look at a good number of examples of creating our own custom hooks.</p><p id=\"\">Without further ado, let’s get started!<br></p><p id=\"\"><strong id=\"\">Prerequisites</strong></p><p id=\"\">Read the below articles to get the most out of this article:</p><ul id=\"\"><li id=\"\"><a href=\"https://reactjs.org/docs/components-and-props.html\" target=\"_blank\" id=\"\">Function- and class-based components</a></li><li id=\"\"><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch\" target=\"_blank\" id=\"\">Fetch API</a></li></ul><h2 id=\"\">What are Custom Hooks?</h2><p id=\"\">React v16.8 introduced hooks, wrappers that help to encapsulate repeated stateful logic so that it can be used and shared later across multiple components.</p><p id=\"\">Hooks allow you to use all class-based components’ life cycle methods in function-based components. They let you use <em id=\"\">useState</em> and other React features without a class.</p><p id=\"\">Having said that, React allows you to create your own custom hooks. A custom hook is a way to share stateful logic across components. We can also follow HOC and render props patterns to share this stateful logic across components; custom hooks are just another way to do it.</p><h2 id=\"\">How to Create a Custom Hook</h2><p id=\"\">To create your own React custom hook, we have to follow certain guidelines. Here is a summary of these rules:</p><ul id=\"\"><li id=\"\">Your custom hook should start with the keyword <em id=\"\">use</em>, for example, <em id=\"\">useAuthState</em>, <em id=\"\">useFetch</em>, etc.</li><li id=\"\">Hooks should be called at the top of the component. We should avoid using hooks inside of a condition or a loop because React will be uncertain about the order of execution of the hooks. React knows about each hook and its associated value via the order of execution of hooks during rendering. It’s expected that at each render, the order of hooks remains the same. In this way, React preserves the state.</li><li id=\"\">Hooks should be called from a function-based component.</li><li id=\"\">You can call one hook from another hook.</li><li id=\"\">Every call to a hook gets an isolated state.</li></ul><p id=\"\">Now that we know some basic rules of hooks, let’s create a simple example:</p><figure id=\"\" class=\"w-richtext-figure-type-image w-richtext-align-fullwidth\" style=\"max-width:1840px\" data-rt-type=\"image\" data-rt-align=\"fullwidth\" data-rt-max-width=\"1840px\"><div id=\"\"><img src=\"https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62fe5c370e6d1334e8062de1_raycast-untitled%20(1).png\" loading=\"lazy\" id=\"\" width=\"auto\" height=\"auto\" alt=\"A code snippet with the React code for a custom hook.\"></div><figcaption id=\"\"><a href=\"https://georgiad.pieces.cloud/?p=b68f48b7e4\" target=\"_blank\" id=\"\">Save to Pieces</a></figcaption></figure><p id=\"\">This is one of the more basic React custom hooks examples. In this hook, we do the following things:</p><ul id=\"\"><li id=\"\">We return an access token, <em id=\"\">isError</em>, and error state.</li><li id=\"\">The purpose of this hook is to return the access token from the local storage or fetch a new one if the access token is not present in the local storage.</li><li id=\"\">We have named this hook <em id=\"\">useAuthState</em>. This satisfies the rule that the name of the hook must start with <em id=\"\">use</em>.</li><li id=\"\">If you carefully observe the code inside this hook, you will find that we need this each and every time we need to use the access token.</li><li id=\"\">This can create a lot of redundant code pretty quickly.</li><li id=\"\">To avoid this, we can make use of such hooks and use this logic in whichever component we require.</li><li id=\"\">While the hook is in use, it gets its own isolated state.</li></ul><p id=\"\">Using this component is also simple. Just import the hook as follows:</p><figure id=\"\" class=\"w-richtext-figure-type-image w-richtext-align-fullwidth\" style=\"max-width:1520px\" data-rt-type=\"image\" data-rt-align=\"fullwidth\" data-rt-max-width=\"1520px\"><div id=\"\"><img src=\"https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62fe5c65d4d8521dc766b30e_raycast-untitled%20(2).png\" loading=\"lazy\" id=\"\" width=\"auto\" height=\"auto\" alt=\"A code snippet that implements the above custom hook.\"></div><figcaption id=\"\"><a href=\"https://georgiad.pieces.cloud/?p=be344a8809\" target=\"_blank\" id=\"\">Save to Pieces</a></figcaption></figure><p id=\"\">Now that we have a basic understanding of custom hooks, let’s dive deep into some more React custom hooks examples.</p><h2 id=\"\">Creating a Custom Hook to Fetch Data</h2><p id=\"\">There might be scenarios where you want to fetch data from an API, but you also need the following data:</p><ul id=\"\"><li id=\"\">Is data fetching? (e.g., <em id=\"\">isLoading)</em></li><li id=\"\">Was data fetched successfully?</li><li id=\"\">Was fetching the data unsuccessful, throwing an error?</li></ul><p id=\"\">In all of the above scenarios, you would do something like this:</p><figure id=\"\" class=\"w-richtext-figure-type-image w-richtext-align-fullwidth\" style=\"max-width:1520px\" data-rt-type=\"image\" data-rt-align=\"fullwidth\" data-rt-max-width=\"1520px\"><div id=\"\"><img src=\"https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62fe5c883b868222d4748477_raycast-untitled%20(3).png\" loading=\"lazy\" id=\"\" width=\"auto\" height=\"auto\" alt=\"A code snippet that creates another custom hook.\"></div><figcaption id=\"\"><a href=\"https://georgiad.pieces.cloud/?p=11a84b92a0\" target=\"_blank\" id=\"\">Save to Pieces</a></figcaption></figure><p id=\"\">You would make use of multiple <em id=\"\">useStates</em> and one <em id=\"\">useEffect</em> to get the data on page load. Imagine you are repeating this multiple times across multiple components.</p><p id=\"\">In such cases, it is suitable for us to create a hook that will abstract this stateful logic. Then we can simply get these values/states as a return value of the hook.</p><p id=\"\">Here we go: we’re going to call <em id=\"\">useFetch</em> as a hook that will fetch the data for us from the given URL/API.</p><figure id=\"\" class=\"w-richtext-figure-type-image w-richtext-align-fullwidth\" style=\"max-width:1520px\" data-rt-type=\"image\" data-rt-align=\"fullwidth\" data-rt-max-width=\"1520px\"><div id=\"\"><img src=\"https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62fe5cac7fb88297a5d5c4d8_raycast-untitled%20(4).png\" loading=\"lazy\" id=\"\" width=\"auto\" height=\"auto\" alt=\"A code snippet with React code.\"></div><figcaption id=\"\"><a href=\"https://georgiad.pieces.cloud/?p=397546920c\" target=\"_blank\" id=\"\">Save to Pieces</a></figcaption></figure><p id=\"\">We just wrapped the above code inside a custom React hook function. There are a couple of things to note about our custom hook:</p><ul id=\"\"><li id=\"\">It has multiple <em id=\"\">useStates,</em> such as <em id=\"\">isLoading</em>, <em id=\"\">isSuccess</em>, etc., that tell us the state of the API at different phases.</li><li id=\"\"><em id=\"\">isLoading</em> - This is set to <em id=\"\">true</em> at the start whenever we start fetching the data inside the <em id=\"\">useEffect</em>. Once the data fetches or an error throws, we set its value to false. We are doing this because we need a way to know that the hook is doing its work. While the hook is working, we can show a spinner on the UI with the help of this toggle. Its default value is <em id=\"\">false</em>.</li><li id=\"\"><em id=\"\">data</em> and <em id=\"\">error</em> - These two states, as the names suggest, store the data and the error that the fetch API throws.</li><li id=\"\"><em id=\"\">isError</em> - This toggle state shows whether an error has occurred or not. Its default value is <em id=\"\">false</em>, but if we get an error during <em id=\"\">fetch</em> API, then we set its value to <em id=\"\">true</em>.</li><li id=\"\"><em id=\"\">isSuccess</em> - This toggle state is set to <em id=\"\">true</em> whenever the data from the <em id=\"\">fetch</em> API fetches successfully. Its default value is <em id=\"\">false</em>.</li><li id=\"\">In the above hook, we introduced a <em id=\"\">setTimeout</em> API inside the <em id=\"\">useEffect</em> because we want to display the loading state. Since the data is fetched quickly, we introduced the <em id=\"\">setTimeout</em> API to showcase the loading state.</li></ul><p id=\"\">The code below demonstrates how we consume this hook:</p><figure id=\"\" class=\"w-richtext-figure-type-image w-richtext-align-fullwidth\" style=\"max-width:1520px\" data-rt-type=\"image\" data-rt-align=\"fullwidth\" data-rt-max-width=\"1520px\"><div id=\"\"><img src=\"https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62fe5cc65c607ad7594831cc_raycast-untitled%20(5).png\" loading=\"lazy\" id=\"\" width=\"auto\" height=\"auto\" alt=\"A code snippet with React code.\"></div><figcaption id=\"\"><a href=\"https://georgiad.pieces.cloud/?p=d0ee4f9ffb\" target=\"_blank\" id=\"\">Save to Pieces</a></figcaption></figure><h2 id=\"\">A Custom Hook to Track Mouse Position</h2><p id=\"\">There might be certain scenarios where you might want to track your mouse movement from the edges of the browser inside a specific div or you want to track it over the entire page. In any case, custom hooks can return the x- and y-coordinates along with a handler function that will manage the track of the mouse event inside an element will do a fine job.<br></p><p id=\"\">So, here we go! We’re going to name this hook useMousePosition. Below is the code for the same:</p><figure id=\"\" class=\"w-richtext-figure-type-image w-richtext-align-fullwidth\" style=\"max-width:1780px\" data-rt-type=\"image\" data-rt-align=\"fullwidth\" data-rt-max-width=\"1780px\"><div id=\"\"><img src=\"https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62fe5cfe954f0fa905cece31_raycast-untitled%20(6).png\" loading=\"lazy\" id=\"\" width=\"auto\" height=\"auto\" alt=\"A code snippet with React code.\"></div><figcaption id=\"\"><a href=\"https://georgiad.pieces.cloud/?p=9e5f418548\" target=\"_blank\" id=\"\">Save to Pieces</a></figcaption></figure><p id=\"\">Here is a bit of explanation for the above code:</p><ul id=\"\"><li id=\"\">First, it has a <em id=\"\">useState</em> as <em id=\"\">mouseCoords</em> we default <em id=\"\">x</em> and <em id=\"\">y</em> values of 0. &nbsp;This state stores the <em id=\"\">x</em> and <em id=\"\">y</em> coordinates of the mouse.</li><li id=\"\">Next, we have a <em id=\"\">handleMouseMovement</em> function. This function is an event handler on <em id=\"\">mousemove</em> events.</li><li id=\"\">Then, we have a <em id=\"\">useEffect</em> that adds an event listener on page load for the event <em id=\"\">mousemove</em>. We remove this event listener when the component is unmounted from <a href=\"https://code.pieces.app/blog/understanding-dom-and-virtual-dom-and-how-they-work-with-react\" target=\"_blank\">the DOM</a>. We do this operation when we want to track the mouse movement across the entire page. This is why we attached the event listener to the window object. To track the mouse position on the entire page, we use a toggle variable called <em id=\"\">global</em>. If it's true, then we track all of the mouse movement.</li><li id=\"\">If <em id=\"\">global</em> is set to false, then the code inside the <em id=\"\">useEffect</em> is not used and the mouse position tracker completely relies on <em id=\"\">handleMouseMovement</em>.</li><li id=\"\">In such a case, while consuming this hook we can pass on the <em id=\"\">handleMouseMovement</em> function to the target element’s <em id=\"\">onMouseMove</em> property to track the cursor position inside that element.</li></ul><p id=\"\">Here is how you will be consuming this hook while targeting mouse tracking on a specific div element:<br></p><figure id=\"\" class=\"w-richtext-figure-type-image w-richtext-align-fullwidth\" style=\"max-width:1780px\" data-rt-type=\"image\" data-rt-align=\"fullwidth\" data-rt-max-width=\"1780px\"><div id=\"\"><img src=\"https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62fe5d1f954a4529b65df220_raycast-untitled%20(7).png\" loading=\"lazy\" id=\"\" width=\"auto\" height=\"auto\" alt=\"A React snippet that consumes custom hooks.\"></div><figcaption id=\"\"><a href=\"https://georgiad.pieces.cloud/?p=8ef3438546\" target=\"_blank\" id=\"\">Save to Pieces</a></figcaption></figure><h2 id=\"\">Custom Hooks to Get CSS&nbsp;Variables</h2><p id=\"\">CSS variables are entities that can be created and reused later inside a document, also called custom properties. We denote them with a special notation like <em id=\"\">--primary-color</em> and we access them using a special function called <em id=\"\">var()</em>.<br></p><p id=\"\">In large projects, we can repeat styles, colors, or sizes in multiple locations. This can get quite difficult to manage and it can also become infeasible to remember these common values.<br></p><p id=\"\">So, it’s always better to have a central place where you can store these values and use them later. You can consider this a central repository of style properties. These variables, once created, can be accessed anywhere in the document via CSS’s <em id=\"\">var()</em> function when you declare them inside the <em id=\"\">:root</em> pseudo-classs selector.</p><p id=\"\">If we compare this methodology in React, then the CSS variables inside these <em id=\"\">:root</em> classes would act as a global state.<br></p><p id=\"\">Now, enough of this intro! Let’s create actual CSS variables. Let’s create two variables <em id=\"\">--primary-color</em> and <em id=\"\">--font-size-large</em>.</p><p id=\"\">Since we’re using a CRA app, by default there’s a <em id=\"\">styles.css</em> file inside the <em id=\"\">src</em> folder. If not, create the file and paste the following code in it:</p><figure id=\"\" class=\"w-richtext-figure-type-image w-richtext-align-fullwidth\" style=\"max-width:1040px\" data-rt-type=\"image\" data-rt-align=\"fullwidth\" data-rt-max-width=\"1040px\"><div id=\"\"><img src=\"https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62fe5d4f954a455ceb5df4e3_raycast-untitled%20(9).png\" loading=\"lazy\" id=\"\" width=\"auto\" height=\"auto\" alt=\"A code snippet with CSS code.\"></div><figcaption id=\"\"><a href=\"https://georgiad.pieces.cloud/?p=d1cc429502\" target=\"_blank\" id=\"\">Save to Pieces</a></figcaption></figure><p id=\"\">Simple usage of these variables would be similar to below:</p><figure id=\"\" class=\"w-richtext-figure-type-image w-richtext-align-fullwidth\" style=\"max-width:1040px\" data-rt-type=\"image\" data-rt-align=\"fullwidth\" data-rt-max-width=\"1040px\"><div id=\"\"><img src=\"https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62fe5d6554fbe1a6b90a6459_raycast-untitled%20(10).png\" loading=\"lazy\" id=\"\" width=\"auto\" height=\"auto\" alt=\"A CSS code snippet.\"></div><figcaption id=\"\"><a href=\"https://georgiad.pieces.cloud/?p=d2c44cb01b\" target=\"_blank\" id=\"\">Save to Pieces</a></figcaption></figure><p id=\"\">Let’s do some of the fun part here! Consider a scenario where you need to access these CSS variables in your component and change it based on a certain value of an API.</p><p id=\"\">You will need to do following:</p><ul id=\"\"><li id=\"\">Create a state variable inside a component</li><li id=\"\">Create a <em id=\"\">useEffect</em> and use JavaScript’s <em id=\"\">getComputedStyle</em> function to access the styles of the <em id=\"\">:root</em> element</li><li id=\"\">Use the <em id=\"\">setProperty</em> function to set the new or existing CSS variable values</li><li id=\"\">Repeat this logic across multiple components</li></ul><p id=\"\">Repeating this logic everywhere would be a hassle. To manage this better, let’s create a React.JS custom hook named <em id=\"\">useCSSVariable</em> to do exactly the same thing.</p><p id=\"\">Copy and paste the below code in your utility or <em id=\"\">CustomHooks.ts </em>file (if one doesn’t exist, then create it):</p><figure id=\"\" class=\"w-richtext-figure-type-image w-richtext-align-fullwidth\" style=\"max-width:1840px\" data-rt-type=\"image\" data-rt-align=\"fullwidth\" data-rt-max-width=\"1840px\"><div id=\"\"><img src=\"https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62fe5d8be1d4e97e6ac552b1_raycast-untitled%20(11).png\" loading=\"lazy\" id=\"\" width=\"auto\" height=\"auto\" alt=\"A React code snippet that creates custom hooks.\"></div><figcaption id=\"\"><a href=\"https://georgiad.pieces.cloud/?p=03ae4089c0\" target=\"_blank\" id=\"\">Save to Pieces</a></figcaption></figure><p id=\"\">Ok, there are some new moving parts to this hook, but trust me. The pattern of creating a custom hook remains the same:</p><ul id=\"\"><li id=\"\"><em id=\"\">useCSSVariable</em> accepts <em id=\"\">targetElement</em> as an argument. <em id=\"\">targetElement</em> is the CSS selector for an element that stores the CSS variables.</li><li id=\"\">Next, we create two state variables: <em id=\"\">cssRootStyles</em> and <em id=\"\">rootElement</em>.</li><li id=\"\"><em id=\"\">cssRootStyles</em> is a state variable that stores all of the computed styles of the <em id=\"\">targetElement</em> via <em id=\"\">getComputedStyle</em>.</li><li id=\"\"><em id=\"\">rootElement</em> is another state variable that will store the <em id=\"\">targetElement</em>. We will use this state to set the CSS variable using <em id=\"\">setProperty</em> function.</li><li id=\"\">Then, we have a <em id=\"\">useEffect</em> that sets the <em id=\"\">rootElement</em> and <em id=\"\">cssRootStyles</em> as a <em id=\"\">targetElement</em> and <em id=\"\">computedStyles</em> of the root element.</li><li id=\"\">We also have <em id=\"\">getCssVariable</em>, which is a simple getter function that gets the CSS variable’s value with the help of <em id=\"\">getPropertyValue</em>. We return the same value from this function.</li><li id=\"\">Next, we have <em id=\"\">setCssVariable</em>, which takes the CSS variable’s name and value and stores them with the help of the <em id=\"\">setProperty</em> function.</li><li id=\"\">Finally, we return these two functions so that we can use the consumer component once it’s mounted.</li></ul><figure id=\"\" class=\"w-richtext-figure-type-image w-richtext-align-fullwidth\" style=\"max-width:1794px\" data-rt-type=\"image\" data-rt-align=\"fullwidth\" data-rt-max-width=\"1794px\"><div id=\"\"><img src=\"https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62fe627cb9de594961b07692_raycast-untitled%20(12).png\" loading=\"lazy\" id=\"\" width=\"auto\" height=\"auto\" alt=\"A React code snippet.\"></div><figcaption id=\"\"><a href=\"https://georgiad.pieces.cloud/?p=e75241858d\" target=\"_blank\" id=\"\">Save to Pieces</a></figcaption></figure><p id=\"\">Here in <em id=\"\">App.js,</em> we simply call the <em id=\"\">useCSSVariable</em> hook. We finally make use of the <em id=\"\">getCssVariable</em> function to fetch the <em id=\"\">--primary-color</em> and <em id=\"\">--font-size-large</em> CSS variables.</p><p id=\"\">Finally, we created a simple button that creates a new CSS variable <em id=\"\">--secondary-color</em> with the value <em id=\"\">#CE8147</em> when it’s clicked.</p><h2 id=\"\">Summary</h2><p id=\"\">So, we learned about hooks and custom hooks in React. We also learned about how we can create our own custom hooks along with some interesting examples, such as a CSS variables fetcher, a fetch API hook, and a few others.</p><p id=\"\">If you’re looking to wrap your stateful logic and share it across multiple components, then you should definitely give custom hooks a try.</p><p id=\"\">Thanks for reading!</p>",
  "Date": "Thu Aug 18 2022 00:00:00 GMT+0000 (Coordinated Universal Time)",
  "Author": "Raman Hundal",
  "Author Photo": "https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62fe5df1954f0f3d07ced8f3_raman.jpeg",
  "AMP URL": "",
  "TOC based on...": "h2,h3",
  "Tags": "javascript; react",
  "CTA": "<p>Check out 16 essential TypeScript snippets</p>",
  "CTA link": "https://code.pieces.app/collections/typescript",
  "Canonical URL": ""
}
