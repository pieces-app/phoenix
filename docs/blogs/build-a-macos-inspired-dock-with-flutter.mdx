![](https://uploads-ssl.webflow.com/6143afec68f555387049efb3/63dd58f4e6dced0ee59640ce_building_macos.jpg)
"flutter; animation"
# Build an Imitation Mac Dock With Flutter
> Wed Apr 05 2023 16:53:15 GMT+0000 (Coordinated Universal Time)
<p>‚Äç<p.new.line><p id="">A couple of months ago, I started doing some UI challenges‚ú® in Flutter. The goal of these challenges was to be creative and explore building unique UI experiences in Flutter while sticking to what the framework offers.<p.new.line><p id="">As a result, I created some üòÅ really interesting animations and designs in Flutter that showcase what you can build with it. In this article, I‚Äôll walk you through one of my creations, inspired by the macOS dock experience.<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:600px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="600px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62df086d4db9388363f9b857_1*hy0goSNRPgf5o8a7LpKe5w.gif" alt="The finished macOS dock animation." id="" width="auto" height="auto" loading="auto"><div.new.line><figure.new.line><p id="">By the end of this article, along with how to build this Flutter dock, you‚Äôll have learned a little more about:<p.new.line><ul id=""><li id="">Constraints in Flutter<li.new.line><li id="">Implicit Animations<li.new.line><li id="">Design breakdown<li.new.line><ul.new.line><h2 id="">Getting Started<h2.new.line><p id=""><a href="https://github.com/rutvik110/MacOS-Inspired-Doc-Starter" target="_blank" id="">Download the starter project</a>. If you're not familiar with Flutter, check out this guide to <a href="https://code.pieces.app/blog/building-a-flutter-web-app-from-scratch-a-complete-guide" target="_blank" id="">building a Flutter app from scratch</a>. <p.new.line><p id="">Once you build it, you‚Äôll see a black screen, but we‚Äôll soon add our animated dock there.üßëüèΩüíª<p.new.line><p id="">Build &amp; run:<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1400px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1400px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62df086da52f0c2f0ffbfd2e_1*bj6kYwmD-J1PWcC-6eahvw.png" alt="The blank screen that appears when running the starter project mentioned above." id="" width="auto" height="auto" loading="auto"><div.new.line><figure.new.line><h2 id="">Constraints And Implicit Animations<h2.new.line><p id="">Before getting our hands dirty in the code, are you familiar with <strong id="">Constraints</strong> and <strong id="">Implicit Animations</strong> in Flutter?ü§î<p.new.line><p id="">If you are, then you can skip the next two sections, which talk about <strong id="">Constraints</strong> and <strong id="">Implicit Animations</strong>, and üèé race straight up to the <strong id="">Design Breakdown</strong> section.<p.new.line><p id="">But if you‚Äôre not familiar, then you should read through the following two sections to understand some basics of these two topics.<p.new.line><h3 id="">Understanding Flutter Constraints<h3.new.line><p id="">UI development in Flutter is quite different from the way it is in HTML and other frameworks.<p.new.line><p id="">We don‚Äôt deal with sizes directly, but rather with constraints. The constraints are basically a set of four points: the min-max width and the min-max height.<p.new.line><p id="">There‚Äôs one rule of thumb that guides Flutter UI development:<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1400px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1400px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62df086d83176b457034f42c_1*uN1lVhVQsalsnzwbaJIuzQ.png" alt="An image that reads &quot;Constraints go down. Sizes go up. Parent sets position.&quot; " id="" width="auto" height="auto" loading="auto"><div.new.line><figcaption id="">From <a href="https://docs.flutter.dev/development/ui/layout/constraints" target="_blank" id="">flutter.dev</a></figcaption><figure.new.line><p id="">While you‚Äôre building Flutter UI, you will see this <strong id="">parent-child composition</strong>. When the parent widget wants to lay out on the screen, it checks if it has any children. If it does, then it passes its constraints to its children and asks them how big/small they want to be. The child widget may repeat this process if it has children of its own.<p.new.line><p id="">Once the Parent gets the sizes for each of its child widgets, it then checks those sizes against its own constraints. Based on this, it calculates the final size for each of its child widgets and lays them out.<p.new.line><p id="">As you can see, the one in control of determining the size and position of a widget is the Parent widget, not the Child widget.<p.new.line><p id="">This is too big a topic to continue in this article; if you want to read about this in more depth, <a href="https://docs.flutter.dev/development/ui/layout/constraints" target="_blank" id="">check out the official docs</a>.<p.new.line><h3 id="">Implicit Animations<h3.new.line><p id="">One of the reasons it's easy to build beautiful Flutter animations is that it provides many ways to animate widgets depending on your use case.<p.new.line><p id="">One of the ways is using <strong id="">AnimatedFoo</strong> widgets (also called &nbsp;<strong id="">Implicit Animation</strong> <strong id="">Widgets</strong>), where <strong id="">Foo</strong> is the property that you want animate.<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:600px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="600px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62df086d8806997592171bbd_1*qWxlRYi5C6u82Qh0nwvlyw.gif" alt="Examples of 5 different Flutter Implicit Animations." id="" width="auto" height="auto" loading="auto"><div.new.line><figure.new.line><p id="">When working with <strong id="">AnimatedFoo</strong> widgets, you only have to worry about providing the property value. AnimatedFoo widgets handle the animation flow, or the transition from the old value to the new value whenever the property value changes. These will be important for our Mac dock later!<p.new.line><p id="">There are different <strong id="">AnimatedFoo</strong> widgets for animating the different properties of a widget, like <strong id="">AnimatedScale</strong>, <strong id="">AnimatedOpacity</strong>, <strong id="">AnimatedSize</strong>, <strong id="">AnimatedContainer</strong>, etc. We‚Äôll be making use of some of these <strong id="">AnimatedFoo</strong> widgets. You can learn more about them in <a href="https://docs.flutter.dev/development/ui/animations/implicit-animations" target="_blank" id="">the official docs</a>.<p.new.line><h2 id="">Mac Dock Design Breakdown<h2.new.line><p id="">When you‚Äôre trying to build animations or any kind of interaction, try to always break down the design into parts. Then, understand each part and its animations and how it‚Äôs affected by other components in the design.<p.new.line><p id="">Below is a breakdown of our MacOS&nbsp;dock design:<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:800px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="800px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62df086d39f1ba4a82db147d_1*OY8DKC6THKb4uU2npbPhJg.gif" alt="An illustration of two different animations combining into one finished Mac dock design." id="" width="auto" height="auto" loading="auto"><div.new.line><figure.new.line><p id="">As you can see, there are two main components here:<p.new.line><ol id=""><li id="">The row of items<li.new.line><li id="">The Mac dock<li.new.line></ol><p id="">The item‚Äôs row is stacked on top of the dock. Both of these components have different behaviors when you hover over any one of the items. Our items scale and translate along the Y-axis while the dock‚Äôs width increases as items are scaled.<p.new.line><p id="">In the next sections, we‚Äôll explore how these Flutter animations work in detail and see how we can implement them.<p.new.line><h3 id="">Adding The Items<h3.new.line><p id="">In <strong id="">lib/macos_doc.dart</strong>, replace the <em id="">//TODO: add items ui</em> with the following code:<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1436px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1436px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62e17da96ee313045988bf7e_raycast-untitled%20(21).png" loading="lazy" id="" width="auto" height="auto" alt="Dart code snippet"><div.new.line><figcaption id=""><a href="https://raman.pieces.cloud/?p=823140b916" target="_blank" id="">Save to Pieces</a></figcaption><figure.new.line><p id="">Let‚Äôs go over the code step-by-step:<p.new.line><ol id=""><li id=""><strong id="">Items Row:</strong> The row holding the items has the <em id="">mainAxisSize</em> set to <em id="">mainAxisSize.min</em>. This tells the row to size itself to the combined width of the items within it, instead of expanding to capture all of the available width along the main axis.<li.new.line><li id=""><strong id="">MouseRegion:</strong> Flutter provides a <strong id="">MouseRegion</strong> widget which we can use to be notified when the user hovers on our item. When the mouse is within the item hover region, we set the <em id="">hoveredIndex</em> to that item‚Äôs index and reset it to <em id="">null</em> when the mouse exits the item‚Äôs hover region.<li.new.line><li id=""><strong id="">AnimatedContainer:</strong> This is the container that holds our item. It‚Äôs an <strong id="">AnimatedContainer</strong> which will animate its scale and translate itself depending on the <em id="">hoveredIndex</em>.<li.new.line><li id=""><strong id="">FittedBox</strong>: If the child of this widget has a size larger than the constraints passed down to it, then this widget will scale and position the child to fit within the constraints based on the fit set.<li.new.line><li id=""><strong id="">The item:</strong> The item in our case is text, so I‚Äôm using the <strong id="">AnimatedDefaultTextStyle</strong> for scaling. Your item can be anything else, including an icon or an SVG. Use the appropriate Flutter animation widgets to get the smooth scale animation for them.<li.new.line></ol><p id="">Build &amp; run:<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1400px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1400px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62df086d197fa036efe4c59d_1*D9MKsUtLdCbEmVxTmRVm1Q.png" alt="The dock items by themselves, without a dock bar or animations." id="" width="auto" height="auto" loading="auto"><div.new.line><figure.new.line><h3 id="">Animating The Items<h3.new.line><p id="">Let‚Äôs dive a little deeper into our item‚Äôs animations.<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1600px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1600px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62df086d0825de4c0b88afa4_1*1lpn-DJAeHBAEOEYqFgjGQ.gif" alt="Examples of two different animations. On the left, the item gets bigger when the mouse hovers over it. On the right, the item raises above the others when the mouse hovers over it. " id="" width="auto" height="auto" loading="auto"><div.new.line><figure.new.line><p id="">Each item on our Mac dock has two animation properties. The first one is the change in its <strong id="">size,</strong> and the second is its <strong id="">translation along the Y-axis</strong>. The item in focus has the max scale and the max translation along the Y-axis. The other items are then scaled and translated accordingly.<p.new.line><p id="">Now, both of these properties change for items depending on their position from the hovered item. The trick to this animation is to calculate these two properties based on the item‚Äôs index and the <em id="">hoveredIndex</em>.<p.new.line><p id="">Let‚Äôs see how we can calculate those values!<p.new.line><p id="">Replace <em id="">//TODO: add getPropertyValue method</em> with the following code :<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1454px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1454px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62e186d5028127109fd56734_raycast-untitled%20(23).png" loading="lazy" id="" width="auto" height="auto" alt="Dart code snippet"><div.new.line><figcaption id=""><a href="https://raman.pieces.cloud/?p=de6c4086f4" target="_blank" id="">Save to Pieces</a></figcaption><figure.new.line><p id="">First of all, if you‚Äôre scared a bit üòÖ because of all of the math this method is screaming at you, don‚Äôt worry! It‚Äôs actually really simple. üòÑ I‚Äôll try my best to explain what‚Äôs going on here.<p.new.line><p id="">The <em id="">getPropertyValue</em> method is a general property value calculator for our scale and translation properties. It has four parameters:<p.new.line><ol id=""><li id=""><strong id="">index: </strong>Index of the item for whom the value needs to be calculated.<li.new.line><li id=""><strong id="">baseValue:</strong> Value when none of the items are in focus.<li.new.line><li id=""><strong id="">maxValue:</strong> Value for the hovered item.<li.new.line><li id=""><strong id="">nonHoveredMaxValue:</strong> Maximum value for the items around the hovered item.<li.new.line></ol><p id="">Let's go over the method step-by-step.<p.new.line><p id="">1. Check if <em id="">hoveredIndex</em> is null. If it is, then return <em id="">baseValue</em>.<p.new.line><p id="">2. Calculate the difference between the <em id="">index</em> of the <strong id="">hovered</strong> item and the <strong id="">current</strong>. Note that <strong id="">we take the positive of the difference</strong>. So, if we try to plot the <em id="">difference</em> for our items by assuming the <em id="">hoveredIndex</em> is <strong id="">2,</strong> then for each <em id="">index</em> we get the following <strong id="">differences</strong> as shown by the graph.<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:517px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="517px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62df086def87d08041c46de7_1*15cnHKBOWtgFk7-W-LbvWg.png" alt="Graph that shows the differences in y-axis translation for each item on our MacOS dock. " id="" width="auto" height="auto" loading="auto"><div.new.line><figure.new.line><p id=""><strong id=""><em id="">[0]</em></strong><em id=""> -&gt; 2, </em><strong id=""><em id="">[1]</em></strong><em id=""> -&gt;1, </em><strong id=""><em id="">[2]</em></strong><em id=""> -&gt;0, </em><strong id=""><em id="">[3]</em></strong><em id="">-&gt;1, </em><strong id=""><em id="">[4]</em></strong><em id="">-&gt;2</em><p.new.line><p id="">Note how the difference is distributed equally on left and right of the <em id="">hoveredIndex</em>.<p.new.line><p id="">3. For the hovered item, the difference would be 0, as <em id="">hoveredIndex</em> and <em id="">index</em> would be the same. So, we return the <em id="">maxValue</em> for it.<p.new.line><p id="">4. If the difference is <strong id="">less than or equal</strong> to the <em id="">itemsAffected</em>, then we do two things. First, calculate a <em id="">ratio</em>, which is the value between 0.0‚Äì1.0 obtained by subtracting the <em id="">difference</em> from <em id="">itemsAffected</em> and then dividing it by <em id="">itemsAffected</em>.<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:517px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="517px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62df086d02b645b5eb770cda_1*8t5h-kBsGYP3sVqS1FES2A.png" alt="Graph showing the ratio of each item. " id="" width="auto" height="auto" loading="auto"><div.new.line><figure.new.line><p id="">Then, the <em id="">propertyValue</em> is calculated by doing a <em id="">lerpDouble</em> over the <em id="">baseValue</em> and <em id="">nonHoveredMaxValue</em>; the ratio decides the <em id="">lerpDouble</em> percentage.<p.new.line><p id="">To understand what <em id="">lerpDouble</em> is actually doing, take a look at the following explainer:<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" data-rt-type="image" data-rt-align="fullwidth"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62df086e7aac5a508505a37d_1*OueSzozK_Qg1sE1eN0KhqA.gif" alt="An example of how ratios change based on changing values." id="" width="auto" height="auto" loading="auto"><div.new.line><figure.new.line><p id=""><strong id="">a</strong> represents <em id="">baseValue</em> and <strong id="">b</strong> represents <em id="">nonHoveredMaxValue</em>.<p.new.line><p id="">For a ratio of <strong id="">0.0,</strong> the <strong id="">lerp</strong> percentage would be <strong id="">0%</strong>, so the <em id="">propertyValue</em> will be <em id="">baseValue</em>. For a ratio of <strong id="">1.0,</strong> the <strong id="">lerp</strong> percentage would be <strong id="">100%</strong>, i.e., the <em id="">nonHoveredMaxValue</em>.<p.new.line><p id="">For any other ratio value, the <em id="">propertyValue</em> will lie between the <em id="">baseValue</em> and the <em id="">nonHoveredMaxValue</em>. Thus, items that are closer to the hoveredIndex will have a slightly greater value than those that are further.<p.new.line><p id="">5. If any of the conditions don‚Äôt match, we simply return the <em id="">baseValue</em>.<p.new.line><p id="">Now, to finally calculate our scale value and translation values for items, replace <em id="">//TODO: add scale and translation calculator methods</em> with the following code:<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1040px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1040px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62e1893c2be5e57c05116f5c_raycast-untitled%20(24).png" loading="lazy" id="" width="auto" height="auto" alt="Dart code snippet"><div.new.line><figcaption id=""><a href="https://raman.pieces.cloud/?p=8e3246a1ca" target="_blank" id="">Save to Pieces</a></figcaption><figure.new.line><p id="">In your item‚Äôs Flutter UI code, replace the <em id="">baseItemHeight</em> with the <em id="">getScaledSize(index)</em> and <em id="">baseTranslationY</em> with the <em id="">getTranslationY(index).</em><p.new.line><p id="">Test your animations by hovering over the items! üôå<p.new.line><p id="">Build &amp; run:<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:800px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="800px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62df086eefb36e213837be97_1*xt_ytKZ1dEV1LBIMbcMmNQ.gif" alt="Both animations working properly for all of the Mac dock items." id="" width="auto" height="auto" loading="auto"><div.new.line><figure.new.line><h2 id="">Adding the Mac Dock<h2.new.line><p id="">The most interesting part of this design is how we size the MacOS dock. If you look at the animation carefully, then you‚Äôll realize that the <strong id="">width of the dock is always equal to the width of the item‚Äôs row</strong> and its <strong id="">height is equal to the baseHeight of the item‚Äôs row when none of the items are in focus</strong>. As the items scale, so does the width of the animated dock.<p.new.line><p id="">But, when the <strong id="">items</strong> are animating, we don‚Äôt know what the width of the item‚Äôs row will be at any point in the interaction. So, how can we get around this?<p.new.line><p id="">We‚Äôll use our knowledge of constraints. We need to position our dock in the <strong id="">Stack</strong> such that the constraints passed down to it will force it to have the maximum width of the <strong id="">Stack</strong> but limit the height to what we want.<p.new.line><p id="">Let‚Äôs see how we can do this!<p.new.line><p id="">Replace <em id="">//TODO: add Dock</em> with the following code:<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1236px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1236px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62e189928da6d0f38c5595d0_raycast-untitled%20(25).png" loading="lazy" id="" width="auto" height="auto" alt="Dart code snippet"><div.new.line><figcaption id=""><a href="https://raman.pieces.cloud/?p=18b44fb793" target="_blank" id="">Save to Pieces</a></figcaption><figure.new.line><p id="">Welcome, <strong id="">Positioned</strong> widget! This Flutter widget is used to position widgets within the Stack. Here we tell the <strong id="">Positioned</strong> widget that the child should be positioned to <strong id="">0</strong> from the <strong id="">left and right edges</strong> of the Stack and will have a <strong id="">height</strong> equal to <em id="">baseItemHeight</em>. These constraints are then passed down to the <strong id="">DecoratedBox</strong>.<p.new.line><p id="">One thing to understand about <strong id="">DecoratedBox</strong> is that it will size itself to its child‚Äôs size when the child is present and the constraints passed to it are not forced constraints.<p.new.line><p id="">Here, as the child is not present, the <strong id="">DecoratedBox</strong> should have zero size, but our <strong id="">Positioned</strong> widget forces it to scale within the constraints we defined as the <strong id="">DecoratedBox</strong> itself doesn‚Äôt provide any information about its size and positioning.<p.new.line><p id="">Hot reload the app one final time to see our complete interaction in action! üíØ<p.new.line><p id="">Build &amp; run:<p.new.line><figure id="" class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:600px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="600px"><div id=""><img src="https://uploads-ssl.webflow.com/6143afec68f555387049efb3/62df086d4db9388363f9b857_1*hy0goSNRPgf5o8a7LpKe5w.gif" alt="The final fully animated inspired Mac Dock." id="" width="auto" height="auto" loading="auto"><div.new.line><figure.new.line><p id="">You did it! ü•≥ You now have a really cool animated dock for your Flutter apps! üíô<p.new.line><p id=""><strong id="">Src Code :</strong> <a href="https://github.com/rutvik110/Flutter-Animations/tree/master/lib/flutter_design_challenges/macos_inspired_doc" target="_blank" id="">MacOS Inspired Dock In Flutter</a><p.new.line><h2 id="">Next Steps<h2.new.line><p id="">üôè Thanks for spending your precious time reading the article. Hope you had a blast üôå reading and learned some cool things!‚Äç If you want to check out my other creations, head over to <a href="https://github.com/rutvik110/Flutter-Animations" target="_blank" id="">this repo</a>. If you're interested in learning more about Flutter animations, check out <a href="https://code.pieces.app/blog/create-mind-blowing-visuals-using-shaders-in-flutter" target="_blank" id="">this tutorial to build shaders</a>!<p.new.line><p id="">Have an AMAZING day and keep Fluttering! üíô<p.new.line><h2 id="">Use Pieces to Store Your Flutter Snippets<h2.new.line><p id="">When developing Flutter creations, you may have tons of widgets that you want to reuse later, but you just don't have them in a safe place where you can access them. You may also comb through Flutter and Dart documentation and want to save examples that come in handy when implementing a new feature or figuring out which widget to use for dif
